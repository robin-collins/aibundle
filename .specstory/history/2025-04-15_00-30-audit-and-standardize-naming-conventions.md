<!-- Generated by SpecStory -->

# Audit and Standardize Naming Conventions (2025-04-15 10:00:37)

_**User**_

### 4. **Audit and Standardize Naming Conventions**

**Problem:**
Minor naming inconsistencies (e.g., `get_output_format` vs. `string_to_output_format`, `toggle_folder_expansion` vs. `toggle_folder_expansion_recursive`).

**Instruction:**
- Review all helper/utility function names for output format, config, and file operations; select one consistent, descriptive style (e.g., always `get_*`, `set_*`, `to_*`, or `convert_*` as appropriate).
- Rename older variants to match; remove/merge any fully redundant helpers.
- In event handler code, ensure function names describe their precise operation and (if needed) update comments for clarity.

**Benefit:**
Improves discoverability and maintains a professional style across the codebase.

---

## **AiBundle Naming Convention Audit/Remediation Checklist**

### 1. **Functions and Methods**
- [ ] **Are all function/method names in `snake_case`?**
- [ ] **Does each name start with a strong, descriptive verb?** (e.g., `load_`, `get_`, `set_`, `find_`, `is_`, `has_`, `run_`)
- [ ] **If a noun is used, is it only when it clarifies the function’s purpose?**
    - Examples: `load_config`, `format_xml_output`, `is_binary_file`, `add_items_iterative`
- [ ] **Is hyphen (`-`) never used in function/method names?** (Use underscore `_`)
- [ ] **Are adjectives/qualifiers placed before the noun?**
    - E.g., `get_current_dir`, `set_default_config`
- [ ] **Accessor pattern:** Use `get_` or direct field if allowed (`fn name()` or `fn get_name()`)
- [ ] **Avoid redundant words:** Don’t include the type in the function name if it’s already clear by context.

### 2. **Structs, Enums, and Types**
- [ ] **Are type names `CamelCase` nouns or noun phrases?**
    - Examples: `AppConfig`, `CopyStats`, `CliOptions`, `Node`, `FullConfig`
- [ ] **Traits:** Use adjectives or abilities: `Display`, `Write`, `Clone`.

### 3. **Constants**
- [ ] **Are all constants in `SCREAMING_SNAKE_CASE`?**
    - E.g., `DEFAULT_SELECTION_LIMIT`, `VERSION`, `ICONS`.

### 4. **Modules and Filenames**
- [ ] **Are module and file names all lowercase, using underscores?**
    - E.g., `app_state.rs`, `format_selected_items.rs` (if function gets split), `cli_options.rs`

### 5. **Tests**
- [ ] **Are test function names descriptive, using `snake_case` and possibly a `test_` prefix?**


---

_**Assistant**_

To address your **Audit and Standardize Naming Conventions** request, I have reviewed the codebase (as provided) for naming consistency, focusing on helper/utility functions for output format, config, and file operations, as well as event handler code. Below are my findings and recommendations for remediation, following your checklist and the project's style rules.

---

## **1. Functions and Methods**

### **A. Output Format Helpers**

#### **Current State**
- `get_output_format` (in `src/cli/options.rs`)
- `string_to_output_format` (in `src/cli/options.rs`)
- `format_json_output`, `format_markdown_output`, `format_xml_output`, `format_llm_output` (in `src/output/`)
- `format_selected_items` (in `src/output/mod.rs`)

#### **Issues**
- Both `get_output_format` and `string_to_output_format` exist, but `get_output_format` is just a wrapper for `string_to_output_format`.
- The naming is inconsistent: `get_` vs. `string_to_`.

#### **Recommendation**
- **Standardize on `to_output_format`** for conversion from string to enum, as this is idiomatic for Rust and clear in intent.
- Remove `get_output_format` and use `to_output_format` everywhere.
- Keep `format_*_output` for formatting functions, as this is clear and consistent.

---

### **B. Config Helpers**

#### **Current State**
- `load_config`, `save_config`, `config_file_path` (in `src/config/mod.rs`)
- `load_merged_config` (in `src/cli/options.rs`)
- `create_ignore_config` (in `src/cli/options.rs`)

#### **Issues**
- `load_merged_config` is a bit ambiguous; it merges CLI and file config, but the name could be more explicit.
- `create_ignore_config` is clear, but could be `build_ignore_config` for consistency with builder pattern, or `to_ignore_config` if it's a conversion.

#### **Recommendation**
- **Rename `load_merged_config` to `get_merged_config`** or `merge_cli_and_file_config` for clarity.
- **Rename `create_ignore_config` to `to_ignore_config`** for conversion clarity.
- Keep `load_config`, `save_config`, `config_file_path` as is (they are clear and idiomatic).

---

### **C. File Operations**

#### **Current State**
- `add_items_iterative`, `list_files`, `normalize_path`, `is_path_ignored_for_iterative`, `collect_all_subdirs`, `count_selection_items_async`, `is_binary_file`, `recursive_search_helper_generic` (in `src/fs/mod.rs`)
- `format_file_content`, `process_directory` (in `src/output/format.rs`)

#### **Issues**
- `is_path_ignored_for_iterative` is verbose and not idiomatic; could be `is_path_ignored_iterative`.
- `add_items_iterative` is clear, but could be `add_items_recursively` if that's the intent.
- `count_selection_items_async` is not actually async (no async/await), so the name is misleading.

#### **Recommendation**
- **Rename `is_path_ignored_for_iterative` to `is_path_ignored_iterative`**.
- **Rename `add_items_iterative` to `add_items_recursively`** if it is truly recursive; otherwise, keep as is.
- **Rename `count_selection_items_async` to `count_selection_items`** unless it is truly asynchronous.
- Keep `normalize_path`, `list_files`, `collect_all_subdirs`, `is_binary_file`, `recursive_search_helper_generic` as is (they are clear and idiomatic).

---

### **D. Event Handlers**

#### **Current State**
- `ClipboardHandler`, `FileOpsHandler`, `KeyboardHandler`, `SearchHandler` (in `src/tui/handlers/`)
- Methods like `toggle_folder_expansion`, `toggle_folder_expansion_recursive` (not shown in provided code, but referenced in your prompt).

#### **Issues**
- If both `toggle_folder_expansion` and `toggle_folder_expansion_recursive` exist, clarify their difference in comments and ensure the names reflect their behavior.
- Handler methods should use strong verbs: `handle_`, `toggle_`, `select_`, `move_`, etc.

#### **Recommendation**
- **If both expansion functions exist, use `toggle_folder_expansion` for single-level and `toggle_folder_expansion_recursive` for multi-level, and document this in comments.**
- Ensure all handler methods use clear, descriptive verbs.

---

## **2. Structs, Enums, and Types**

- All type names (`AppConfig`, `CopyStats`, `CliOptions`, `Node`, `FullConfig`, etc.) are in `CamelCase` and are nouns. **No changes needed.**

---

## **3. Constants**

- All constants (`DEFAULT_SELECTION_LIMIT`, `VERSION`, `ICONS`, etc.) are in `SCREAMING_SNAKE_CASE`. **No changes needed.**

---

## **4. Modules and Filenames**

- All module and file names are lowercase with underscores. **No changes needed.**

---

## **5. Tests**

- Not enough test code shown to audit. **No action at this time.**

---

# **Summary Table of Proposed Changes**

| Old Name                        | New Name/Action                | Rationale                                 |
|----------------------------------|-------------------------------|-------------------------------------------|
| `get_output_format`              | Remove, use `to_output_format`| Standardize conversion naming             |
| `string_to_output_format`        | Rename to `to_output_format`  | Standardize conversion naming             |
| `load_merged_config`             | `get_merged_config` or `merge_cli_and_file_config` | Clarity                                   |
| `create_ignore_config`           | `to_ignore_config`            | Standardize conversion naming             |
| `is_path_ignored_for_iterative`  | `is_path_ignored_iterative`   | Consistency, brevity                      |
| `add_items_iterative`            | `add_items_recursively` (if recursive) | Clarity                                   |
| `count_selection_items_async`    | `count_selection_items`       | Not actually async                        |
| `toggle_folder_expansion`/`toggle_folder_expansion_recursive` | Clarify/document difference | Consistency, clarity                      |

---

# **Next Steps**

1. **Approve these recommendations** or suggest any preferred naming patterns.
2. Once approved, I will:
   - Rename the functions and update all usages across the codebase.
   - Remove redundant helpers.
   - Update comments for clarity where needed.

**Would you like to proceed with these recommendations, or do you have any preferred naming patterns or exceptions?**

---

_**User**_

approved, proceed

---

_**Assistant**_

Great! Here’s the plan for implementing the approved naming convention changes:

### **Planned Edits**

#### 1. Output Format Helpers
- Rename `string_to_output_format` → `to_output_format`.
- Remove `get_output_format` and update all usages to use `to_output_format`.

#### 2. Config Helpers
- Rename `load_merged_config` → `get_merged_config`.
- Rename `create_ignore_config` → `to_ignore_config`.
- Update all usages accordingly.

#### 3. File Operations
- Rename `is_path_ignored_for_iterative` → `is_path_ignored_iterative`.
- Rename `add_items_iterative` → `add_items_recursively` (since it is recursive).
- Rename `count_selection_items_async` → `count_selection_items`.
- Update all usages accordingly.

#### 4. Event Handlers
- Ensure any `toggle_folder_expansion`/`toggle_folder_expansion_recursive` functions are clearly named and commented (if both exist).

#### 5. Remove Redundant Helpers
- Remove any helpers that are now redundant after renaming.

#### 6. Update Comments
- Update comments for renamed functions to clarify their purpose if needed.

---

I will begin by renaming the output format helpers and updating all usages.

---

<details>
            <summary>Grep search for "string_to_output_format" • **1** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/cli/options.rs` | L149 | `pub fn string_to_output_format(format: &str) -> OutputFormat {` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/cli/options.rs` | L159 | `string_to_output_format(&cli_opts.format)` |

</details>

---

<details>
            <summary>Grep search for "get_output_format" • **1** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/cli/options.rs` | L158 | `pub fn get_output_format(cli_opts: &CliOptions) -> OutputFormat {` |

</details>

---

<details>
            <summary>Grep search for "load_merged_config" • **1** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/cli/options.rs` | L126 | `pub fn load_merged_config(cli_opts: &CliOptions) -> io::Result<FullConfig> {` |

</details>

---

<details>
            <summary>Grep search for "create_ignore_config" • **1** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/cli/options.rs` | L138 | `pub fn create_ignore_config(cli_opts: &CliOptions) -> IgnoreConfig {` |

</details>

---

<details>
            <summary>Grep search for "is_path_ignored_for_iterative" • **3** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/fs/mod.rs` | L57 | `entries.retain(|p| !is_path_ignored_for_iterative(p, base_dir, ignore_config));` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/fs/mod.rs` | L79 | `pub fn is_path_ignored_for_iterative(` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/fs/mod.rs` | L138 | `&& !is_path_ignored_for_iterative(&path, &base_dir_buf, ignore_config)` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/fs/mod.rs` | L166 | `if is_path_ignored_for_iterative(&current, base_dir, ignore_config) {` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/tui/handlers/file_ops.rs` | L7 | `use crate::fs::is_path_ignored_for_iterative;` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/tui/handlers/file_ops.rs` | L73 | `!is_path_ignored_for_iterative(p, &app_state.current_dir, &app_state.ignore_config)` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/tui/handlers/file_ops.rs` | L127 | `if !is_path_ignored_for_iterative(` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/monolithic/main.rs` | L683 | `.filter(|p| !is_path_ignored_for_iterative(p, &self.current_dir, &self.ignore_config))` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/monolithic/main.rs` | L1114 | `entries.retain(|p| !is_path_ignored_for_iterative(p, base_path, &self.ignore_config));` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/monolithic/main.rs` | L1971 | `entries.retain(|p| !is_path_ignored_for_iterative(p, base_dir, ignore_config));` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/monolithic/main.rs` | L1993 | `fn is_path_ignored_for_iterative(` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/monolithic/main.rs` | L2052 | `&& !is_path_ignored_for_iterative(&path, &base_dir_buf, ignore_config)` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/monolithic/main.rs` | L2830 | `if is_path_ignored_for_iterative(&current, base_dir, ignore_config) {` |

</details>

---

<details>
            <summary>Grep search for "add_items_iterative" • **4** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/fs/mod.rs` | L35 | `pub fn add_items_iterative(` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/fs/mod.rs` | L72 | `add_items_iterative(items, &entry, expanded_folders, ignore_config, base_dir)?;` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/tui/state/app_state.rs` | L2 | `use crate::fs::add_items_iterative;` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/tui/state/app_state.rs` | L222 | `add_items_iterative(` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/tui/handlers/file_ops.rs` | L32 | `// Use the add_items_iterative function from fs module to populate app_state.items` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/tui/handlers/file_ops.rs` | L33 | `crate::fs::add_items_iterative(` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/monolithic/main.rs` | L656 | `add_items_iterative(` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/monolithic/main.rs` | L1949 | `fn add_items_iterative(` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/monolithic/main.rs` | L1986 | `add_items_iterative(items, &entry, expanded_folders, ignore_config, base_dir)?;` |

</details>

---

<details>
            <summary>Grep search for "count_selection_items_async" • **4** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/fs/mod.rs` | L152 | `pub fn count_selection_items_async(` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/tui/state/selection.rs` | L76 | `let result = crate_fs::count_selection_items_async(` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/tui/state/selection.rs` | L177 | `let result = crate_fs::count_selection_items_async(` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/monolithic/main.rs` | L992 | `let result = count_selection_items_async(` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/monolithic/main.rs` | L2816 | `fn count_selection_items_async(` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/tui/state/selection.rs` | L76 | `let result = crate_fs::count_selection_items_async(` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/tui/state/selection.rs` | L177 | `let result = crate_fs::count_selection_items_async(` |

</details>

---

<details>
            <summary>Grep search for "toggle_folder_expansion" • **3** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/tui/handlers/file_ops.rs` | L320 | `pub fn toggle_folder_expansion(` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/tui/handlers/file_ops.rs` | L395 | `pub fn toggle_folder_expansion_recursive(` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/tui/handlers/keyboard.rs` | L139 | `KeyCode::Tab => FileOpsHandler::toggle_folder_expansion(app_state, selection_state),` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/src/tui/handlers/keyboard.rs` | L141 | `FileOpsHandler::toggle_folder_expansion_recursive(app_state, selection_state)` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/monolithic/main.rs` | L899 | `KeyCode::Tab => self.toggle_folder_expansion()?,` |
| `vscode-remote://wsl%2Bubuntu/home/tech/projects/aibundle-modular/monolithic/main.rs` | L1623 | `fn toggle_folder_expansion(&mut self) -> io::Result<()> {` |

</details>

---



---



---

